<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>XOM TV - Telewebion Edition</title>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; background: linear-gradient(135deg, #1e3c72, #2a5298); color: #fff; min-height: 100vh; }
    .header { background: rgba(0,0,0,0.3); padding: 20px; text-align: center; }
    .header h1 { font-size: 2.5em; color: #4ecca3; margin-bottom: 10px; }
    .nav-buttons { display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; padding: 15px; position: relative; }
    .nav-btn { background: #4ecca3; color: #1e3c72; border: none; padding: 10px 20px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: all 0.3s; }
    .nav-btn:hover, .nav-btn.active { background: #45b393; transform: scale(1.05); }
    .dropdown-menu { position: absolute; top: 100%; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.9); border-radius: 10px; padding: 10px; min-width: 200px; z-index: 1000; margin-top: 5px; display: none; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
    .dropdown-menu.show { display: block; }
    .dropdown-item { padding: 10px 15px; cursor: pointer; border-radius: 5px; transition: all 0.2s; margin: 2px 0; background: rgba(255,255,255,0.1); }
    .dropdown-item:hover { background: rgba(78,204,163,0.3); transform: translateX(5px); }
    .container { display: flex; height: calc(100vh - 200px); padding: 0 20px 20px 20px; gap: 20px; }
    .channel-list { width: 300px; background: rgba(0,0,0,0.4); overflow-y: auto; border-radius: 10px; padding: 10px; }
    .video-container { flex: 1; background: #000; border-radius: 10px; overflow: hidden; display: flex; flex-direction: column; }
    .video-header { background: rgba(0,0,0,0.8); padding: 15px; display: flex; justify-content: space-between; align-items: center; }
    .video-title { font-size: 1.3em; color: #4ecca3; }
    .video-controls { display: flex; gap: 10px; }
    .btn { background: #4ecca3; color: #1e3c72; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; }
    .btn:hover { background: #45b393; }
    .video-wrapper { flex: 1; position: relative; background: #000; }
    video, iframe { width: 100%; height: 100%; object-fit: contain; border: none; }
    .error-msg { text-align: center; padding: 40px; }
    .category-title { font-weight: bold; font-size: 1.2em; padding: 10px; color: #4ecca3; border-bottom: 2px solid #4ecca3; margin: 10px 0; }
    .channel-item { padding: 12px; margin: 5px 0; cursor: pointer; border-radius: 8px; background: rgba(255,255,255,0.1); display: flex; justify-content: space-between; }
    .channel-item:hover { background: rgba(78,204,163,0.3); }
    .channel-item.active { background: rgba(78,204,163,0.5); font-weight: bold; }
    .channel-item.telewebion { background: rgba(128,0,128,0.5); border-left: 4px solid #4ecca3; }
    .tag { font-size: 0.7em; opacity: 0.8; margin-left: 4px; color: #ffd700; }
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-thumb { background: #4ecca3; border-radius: 4px; }
    .close-btn { display: none; }
    @media (max-width: 768px) {
      .container { flex-direction: column; height: auto; }
      .channel-list { position: fixed; left: 0; top: 0; width: 100%; height: 100%; z-index: 1000; transform: translateX(-100%); transition: transform 0.3s ease; }
      .channel-list.show { transform: translateX(0); }
      .close-btn { display: block; position: fixed; top: 20px; right: 20px; background: #dc3545; color: white; border: none; padding: 10px 20px; z-index: 1001; }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>XOM TV</h1>
    <p>Alla iranska TV-kanaler + Telewebion</p>
  </div>

  <div class="nav-buttons">
    <button class="nav-btn active" onclick="showAll()">Alla kanaler</button>
    <button class="nav-btn" onclick="filterCat('national')">1. Nationella</button>
    <button class="nav-btn" onclick="filterCat('regional')">2. Regionala</button>
    <button class="nav-btn" onclick="filterCat('kurdish')">3. Kurdiska</button>
    <button class="nav-btn" id="karwan-btn" onclick="toggleDropdown(event)">4. Karwan TV â–¾</button>
    <div class="dropdown-menu" id="karwan-dd">
      <div class="dropdown-item" onclick="filterKarwan('all')">Alla Karwan</div>
      <div class="dropdown-item" onclick="filterKarwan('blue')">Kids</div>
      <div class="dropdown-item" onclick="filterKarwan('purple')">Movie</div>
      <div class="dropdown-item" onclick="filterKarwan('pink')">Dubbad</div>
    </div>
    <button class="nav-btn" onclick="filterCat('websites')">5. Webbplatser</button>
    <button class="nav-btn" onclick="filterCat('telewebion')">ðŸ“º TELEWEBION</button>
  </div>

  <div class="container">
    <aside class="channel-list" id="channel-list">
      <button class="close-btn" onclick="toggleList()">âœ• StÃ¤ng</button>
      <div id="ch-container"></div>
    </aside>
    <main class="video-container">
      <div class="video-header">
        <div class="video-title" id="ch-title">VÃ¤lj en kanal</div>
        <div class="video-controls">
          <button class="btn" onclick="toggleList()">ðŸ“º Kanaler</button>
          <button class="btn" onclick="fs()">â›¶ FullskÃ¤rm</button>
          <button class="btn" onclick="reload()">â†» Ladda om</button>
        </div>
      </div>
      <div class="video-wrapper" id="vwrap">
        <div class="error-msg"><h3>ðŸ‘ˆ VÃ¤lj en kanal</h3></div>
      </div>
    </main>
  </div>

<script>
  const channels = {
    // Dina befintliga nationella kanaler
    national: [
      { name: 'TV1', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226637/1.m3u8', method: 'hls', color: 'green' },
      { name: 'TV2', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226176/2.m3u8', method: 'hls', color: 'green' },
      { name: 'TV3', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226868/3.m3u8', method: 'hls', color: 'green' },
      { name: 'TV4', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226140/2.m3u8', method: 'hls', color: 'green' },
      { name: 'Tehran', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226141/2.m3u8', method: 'hls', color: 'green' },
      { name: 'Nasim', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226653/index.m3u8', method: 'hls', color: 'green' },
      { name: 'Varzesh', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226845/3.m3u8', method: 'hls', color: 'green' },
      { name: 'IRINN', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226142/2.m3u8', method: 'hls', color: 'green' },
      { name: 'IRINN 2', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221227020/2.m3u8', method: 'hls', color: 'green' },
      { name: 'Press TV', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226156/2.m3u8', method: 'hls', color: 'green' },
      { name: 'iFilm Farsi', url: 'https://live.presstv.ir/hls/ifilmfa.m3u8', method: 'hls', color: 'blue' },
      { name: 'iFilm English', url: 'https://live.presstv.ir/hls/ifilmen.m3u8', method: 'hls', color: 'blue' }
    ],

    regional: [
      { name: 'KORDESTAN', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226647/2.m3u8', method: 'hls', color: 'cyan' },
      { name: 'ABADAN', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221227000/2.m3u8', method: 'hls', color: 'cyan' },
      { name: 'ARAK', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226899/2.m3u8', method: 'hls', color: 'cyan' },
      { name: 'QAZVIN', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226888/2.m3u8', method: 'hls', color: 'cyan' },
      { name: 'LORESTAN', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226675/2.m3u8', method: 'hls', color: 'cyan' },
      { name: 'KERMAN', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226856/2.m3u8', method: 'hls', color: 'cyan' },
      { name: 'ESFEHAN', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226652/2.m3u8', method: 'hls', color: 'cyan' },
      { name: 'FARS', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226701/2.m3u8', method: 'hls', color: 'cyan' },
      { name: 'YAZD', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221227023/2.m3u8', method: 'hls', color: 'cyan' },
      { name: 'GILAN', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226902/2.m3u8', method: 'hls', color: 'cyan' },
      { name: 'TABRIZ', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226423/2.m3u8', method: 'hls', color: 'cyan' },
      { name: 'URMIA', url: 'https://lenz.splus.ir/PLTV/88888888/224/3221226800/2.m3u8', method: 'hls', color: 'cyan' }
    ],

    kurdish: [
      { name: 'Zagros', url: 'https://5a3ed7a72ed4b.streamlock.net/zagrostv/SMIL:myStream.smil/playlist.m3u8', method: 'hls', color: 'green' },
      { name: 'Rudaw', url: 'https://svs.itworkscdn.net/rudawlive/rudawlive.smil/playlist.m3u8', method: 'hls', color: 'green' },
      { name: 'Kurdsat HD', url: 'https://hlspackager.akamaized.net/live/DB/KURDSAT_HD/HLS/KURDSAT_HD.m3u8', method: 'hls', color: 'green' },
      { name: 'NRT News', url: 'https://media.streambrothers.com:1936/8226/8226/playlist.m3u8', method: 'hls', color: 'green' },
      { name: 'TRT KurdÃ®', url: 'https://tv-trtkurdi.medya.trt.com.tr/master_1440.m3u8', method: 'hls', color: 'green' }
    ],

    karwan: [
      { name: 'Kidco TV', url: 'https://karwan.tv/kidco-tv', method: 'external', color: 'blue', subgroup: 'blue' },
      { name: 'MMN Movies', url: 'https://karwan.tv/mmn-movies', method: 'external', color: 'purple', subgroup: 'purple' },
      { name: 'MMN Drama', url: 'https://karwan.tv/mmn-drama', method: 'external', color: 'pink', subgroup: 'pink' }
    ],

    websites: [
      { name: 'IMVBox', url: 'https://www.imvbox.com/en', method: 'external', color: 'orange' },
      { name: 'Parsa TV', url: 'https://parsatv.com', method: 'external', color: 'orange' },
      { name: 'Telewebion', url: 'https://telewebion.ir/', method: 'external', color: 'orange' }
    ],

    // NY TELEWEBION GRUPP - Alla dina telewebion-kanaler
    telewebion: [
      { name: 'ðŸ“¡ TAMASHA', url: 'https://telewebion.ir/live/hdtest', method: 'iframe', color: 'purple' },
      { name: 'ðŸ“¡ POOYA', url: 'https://telewebion.ir/live/pooya', method: 'iframe', color: 'blue' },
      { name: 'ðŸ“¡ IFILM', url: 'https://telewebion.ir/live/ifilm', method: 'iframe', color: 'green' },
      { name: 'ðŸ“¡ NAMAYESH', url: 'https://telewebion.ir/live/namayesh', method: 'iframe', color: 'orange' },
      { name: 'ðŸ“¡ TEHRAN', url: 'https://telewebion.ir/live/tehran', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ MOSTANAD', url: 'https://telewebion.ir/live/mostanad', method: 'iframe', color: 'brown' },
      { name: 'ðŸ“¡ QURAN', url: 'https://telewebion.ir/live/quran', method: 'iframe', color: 'green' },
      { name: 'ðŸ“¡ AMOUZESH', url: 'https://telewebion.ir/live/amouzesh', method: 'iframe', color: 'blue' },
      { name: 'ðŸ“¡ SALAMAT', url: 'https://telewebion.ir/live/salamat', method: 'iframe', color: 'green' },
      { name: 'ðŸ“¡ OFOGH', url: 'https://telewebion.ir/live/ofogh', method: 'iframe', color: 'purple' },
      { name: 'ðŸ“¡ OMID', url: 'https://telewebion.ir/live/omid', method: 'iframe', color: 'pink' },
      { name: 'ðŸ“¡ SEPEHR', url: 'https://telewebion.ir/live/sepehr', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ FARATAR', url: 'https://telewebion.ir/live/faratar', method: 'iframe', color: 'grey' },
      { name: 'ðŸ“¡ IRINN2', url: 'https://telewebion.ir/live/irinn2', method: 'iframe', color: 'green' },
      { name: 'ðŸ“¡ URMIA', url: 'https://telewebion.ir/live/azarbayjangharbi', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ SAHAND', url: 'https://telewebion.ir/live/sahand', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ ALBORZ', url: 'https://telewebion.ir/live/alborz', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ ESFAHAN', url: 'https://telewebion.ir/live/esfahan', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ SABALAN', url: 'https://telewebion.ir/live/sabalan', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ ILAM', url: 'https://telewebion.ir/live/ilam', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ BUSHEHR', url: 'https://telewebion.ir/live/bushehr', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ JAHANBIN', url: 'https://telewebion.ir/live/jahanbin', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ ABADAN', url: 'https://telewebion.ir/live/abadan', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ KH.RAZAVI', url: 'https://telewebion.ir/live/khorasanrazavi', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ ATRAK', url: 'https://telewebion.ir/live/atrak', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ KHALIJFARS', url: 'https://telewebion.ir/live/khalijefars', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ KHOZESTAN', url: 'https://telewebion.ir/live/khoozestan', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ ESHRAGH', url: 'https://telewebion.ir/live/eshragh', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ SEMNAN', url: 'https://telewebion.ir/live/semnan', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ HAMON', url: 'https://telewebion.ir/live/hamoon', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ FARS', url: 'https://telewebion.ir/live/fars', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ GHAZVIN', url: 'https://telewebion.ir/live/qazvin', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ NOOR', url: 'https://telewebion.ir/live/noor', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ LORESTAN', url: 'https://telewebion.ir/live/aflak', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ KERMAN', url: 'https://telewebion.ir/live/kerman', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ ZAGROS', url: 'https://telewebion.ir/live/zagros', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ DENA', url: 'https://telewebion.ir/live/dena', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ KISH', url: 'https://telewebion.ir/live/kish', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ GOLESTAN', url: 'https://telewebion.ir/live/sabz', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ BARAN', url: 'https://telewebion.ir/live/baran', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ KORDESTAN', url: 'https://telewebion.ir/live/kordestan', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ YAZD', url: 'https://telewebion.ir/live/taban', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ TABARESTAN', url: 'https://telewebion.ir/live/tabarestan', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ AFTAB', url: 'https://telewebion.ir/live/aftab', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ MAHABAD', url: 'https://telewebion.ir/live/mahabad', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ HAMADAN', url: 'https://telewebion.ir/live/sina', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ KHAVARAN', url: 'https://telewebion.ir/live/khavaran', method: 'iframe', color: 'cyan' },
      { name: 'ðŸ“¡ 1+', url: 'https://telewebion.ir/live/tv1plus', method: 'iframe', color: 'green' },
      { name: 'ðŸ“¡ HABIB', url: 'https://telewebion.ir/live/habib', method: 'iframe', color: 'blue' },
      { name: 'ðŸ“¡ SARBEDARAN', url: 'https://telewebion.ir/live/sarbedaran', method: 'iframe', color: 'purple' },
      { name: 'ðŸ“¡ NESFEJAHAN', url: 'https://telewebion.ir/live/nesfejahan', method: 'iframe', color: 'orange' }
    ]
  };

  let hlsInst = null;
  let cur = null;
  let curFilter = null;
  let curSub = 'all';

  function render(filter, sub) {
    curFilter = filter; 
    curSub = sub || 'all';
    
    const catNames = { 
      national:'Nationella', 
      regional:'Regionala', 
      kurdish:'Kurdiska', 
      karwan:'Karwan TV', 
      websites:'Webbplatser',
      telewebion:'ðŸ“º TELEWEBION' 
    };

    const row = ch => {
      const method = ch.method || 'hls';
      const badge = method === 'iframe' ? ' <span class="tag">ðŸ“¡</span>' : method === 'external' ? ' <span class="tag">â†—</span>' : '';
      return `<div class="channel-item ${ch.color || ''}${cur && cur.url === ch.url ? ' active' : ''}" onclick="play('${ch.url.replace(/'/g, "\\'")}', '${ch.name.replace(/'/g, "\\'")}', '${method}')">
        <span>${ch.name}${badge}</span>
      </div>`;
    };

    let html = '';
    if (filter === 'karwan') {
      const list = curSub === 'all' ? channels.karwan : channels.karwan.filter(c => c.subgroup === curSub);
      html = '<div class="category-title">Karwan TV</div>' + list.map(row).join('');
    } else if (filter) {
      html = `<div class="category-title">${catNames[filter]}</div>` + channels[filter].map(row).join('');
    } else {
      Object.keys(channels).forEach(cat => {
        html += `<div class="category-title">${catNames[cat]}</div>` + channels[cat].map(row).join('');
      });
    }
    document.getElementById('ch-container').innerHTML = html;
  }

  function setActive(btn) {
    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
  }

  function showAll() {
    setActive(document.querySelector('.nav-btn'));
    closeDD(); 
    render(null);
  }

  function filterCat(cat) {
    const btn = event.target;
    setActive(btn);
    closeDD(); 
    render(cat);
  }

  function filterKarwan(sub) {
    setActive(document.getElementById('karwan-btn'));
    closeDD(); 
    render('karwan', sub);
  }

  function toggleDropdown(e) {
    e.stopPropagation();
    const dd = document.getElementById('karwan-dd');
    dd.classList.toggle('show');
  }

  function closeDD() { 
    document.getElementById('karwan-dd').classList.remove('show'); 
  }

  function toggleList() { 
    document.getElementById('channel-list').classList.toggle('show'); 
  }

  function play(url, name, method) {
    if (window.innerWidth <= 768) toggleList();
    cur = {url, name, method};
    document.getElementById('ch-title').textContent = name;

    if (hlsInst) { hlsInst.destroy(); hlsInst = null; }

    const wrap = document.getElementById('vwrap');

    if (method === 'external') { 
      window.open(url, '_blank'); 
      return; 
    }

    if (method === 'iframe') {
      // Specialhantering fÃ¶r telewebion
      if (url.includes('telewebion.ir')) {
        wrap.innerHTML = `<div style="width:100%;height:100%;overflow:hidden;">
          <iframe src="${url}" allowfullscreen allow="autoplay; fullscreen" 
            style="width:200%;height:200%;transform:scale(0.5) translateY(-12%);transform-origin:0 0;border:none;">
          </iframe>
        </div>`;
      } else {
        wrap.innerHTML = `<iframe src="${url}" allowfullscreen allow="autoplay; fullscreen" style="width:100%;height:100%;border:none;"></iframe>`;
      }
      render(curFilter, curSub);
      return;
    }

    // HLS
    wrap.innerHTML = '<video id="vplayer" controls autoplay style="width:100%;height:100%;"></video>';
    const vid = document.getElementById('vplayer');

    if (Hls.isSupported()) {
      hlsInst = new Hls();
      hlsInst.loadSource(url);
      hlsInst.attachMedia(vid);
      hlsInst.on(Hls.Events.MANIFEST_PARSED, () => vid.play().catch(() => {}));
    } else if (vid.canPlayType('application/vnd.apple.mpegurl')) {
      vid.src = url;
    }
    render(curFilter, curSub);
  }

  function reload() { 
    if (cur) play(cur.url, cur.name, cur.method); 
  }

  function fs() {
    const w = document.getElementById('vwrap');
    document.fullscreenElement ? document.exitFullscreen() : w.requestFullscreen();
  }

  // Init
  render(null);
</script>
</body>
</html>
